<!DOCTYPE html> <html lang="en-GB" >
<head>
<title>StoryPlayer click as a plugin?</title>
<script type="text/javascript" src="https://emp.test.bbci.co.uk/emp/smpj-branch/storykit-ui/bump-4.js"></script>
</head>
<body>
<div>
 <div id="mp" style="width:700px"></div>
<h3>
<ul id="selection">
<li><a href="#examples/demo1">Demo 1</a>
<li><a href="#examples/demo2">Demo 2</a>
<li><a href="#examples/demo3">Demo 3</a>
<li><a href="#examples/demo4">Demo 4</a>
<li><a href="#examples/demo5">Demo 5</a>
</div>


<script type="text/javascript">
document.cookie = "ckns_html5Debug=true;path=/;"
var all=document.querySelectorAll('#selection li a');
for (var i=0;i<all.length;i++) {
  all[i].onclick=load;
}

function load(ev) {
  var json="../"+ev.currentTarget.href.split('#')[1]+".json";
  console.log("SMP-SP:" + json)
  loadIt(json);
}

function loadIt(jsonUrl) {
  var pluginUrl=(location.href.split('#')[0]);
  pluginUrl = pluginUrl.substring(0,pluginUrl.lastIndexOf('/'))+'/../dist/plugin.js';
  var settings = {
      superResponsive:true,
      allowCasting: true,
      noTracking: true, // Probably should set this true until we handle it correctly
      threeSixty: true,
      noAutomaticNextQueued: false,
      ui:{
        controls:{
          // Rest of configuration set in SMPControls.js
          enabled: true,
          // The following cannot be called in code
          includeBackIntervalButton: true,
          includeForwardIntervalButton: true,
        },
        skin: "storykit",
        playbackSettingsPanel:{enabled:true},
        cta:{enabled:false},
        colour:'#3cffd5',
      },
      plugins: {
        toLoad: [{
            html:pluginUrl,
            data:[
                {
                    name: "storyJsonUrl",
                    data: jsonUrl,
                },
                {
                    name: "queryString",
                    data: window.location.search,
                },
                {
                    name: "cssInclude",
                    data: '../dist/plugin.css'
                }
            ]
        }]
      }
  };
  var mp = window.embeddedMedia.api.player(document.getElementById('mp'),settings);
  mp.load();
}

var hsh=(location.hash+'').slice(1);
if (hsh.length>0) {
  loadIt("../"+hsh+".json");
}

</script>
</body>
</html>
